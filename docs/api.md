## Методы API

### Аутентификация и авторизация
Авторизация пользователя осуществляется посредством отправки
access токена в заголовках запроса в формате Authorization: Bearer <токен>
и необходима для всех запросов кроме тех, что описаны в "Аутентификация и авторизация" и регистрации.

##### Вход
```
POST /auth/login
```
JSON форма:

| Название | Тип | Примечание |
|----------|-----|------------|
| email    | str |            |
| password | str |            |

Результат:

| Название      | Тип | Примечание      |
|---------------|-----|-----------------|
| access_token  | str |                 |
| refresh_token | str |                 |
| type          | str | Значение Bearer |

Ошибки:
403 - email или пароль неправильные

##### Обновление токенов
```
POST /auth/token
```
JSON форма:

| Название      | Тип | Примечание |
|---------------|-----|------------|
| refresh_token | str |            |

Результат:

| Название      | Тип | Примечание      |
|---------------|-----|-----------------|
| access_token  | str |                 |
| refresh_token | str |                 |
| type          | str | Значение Bearer |

Ошибки:
403 - refresh токен невалидный, необходима повторная аутентификация

##### Сброс пароля
```
PATCH /auth/password
```
JSON форма:

| Название     | Тип | Примечание                         |
|--------------|-----|------------------------------------|
| email        | str |                                    |
| new_password | str |                                    |
| code         | str | Код, заранее отправленный на email |

Результат:

Code 204

Ошибки:
400 - неверный код верификации

##### Отправка кода верификации для сброса пароля
```
POST /auth/password/email/verify
```

JSON форма:

| Название     | Тип | Примечание                         |
|--------------|-----|------------------------------------|
| email        | str |                                    |

Результат:

Code 204

### Пользователи
##### Регистрация пользователя
```
POST /users
```

JSON форма:

| Название | Тип         | Примечание |
|----------|-------------|------------|
| email    | str         |            |
| username | str         |            |
| password | str         |            |
| avatar   | str or null |            |

Результат:

Code 204

Ошибки:
409 - Пользователь с таким email или username уже найден

##### Отправка кода верификации для регистрации

JSON форма:

| Название     | Тип | Примечание                         |
|--------------|-----|------------------------------------|
| email        | str |                                    |

Результат:

Code 204

Ошибки:

409 - Пользователь с таким email уже найден

##### Текущий пользователь
```
GET /users/@me
```

Результат:

User

##### Редактирование текущего пользователя
```
PATCH /users/@me    
```

JSON форма:

| Название         | Тип         | Примечание                          |
|------------------|-------------|-------------------------------------|
| email            | str or null |                                     |
| username         | str or null |                                     |
| avatar           | str or null |                                     |
 | new_password     | str or null |                                     |
 | current_password | str or null | Необходимо если указан new_password |
 | code             | str or null | Необходим если указан email         |

Результат:

Code 204

Ошибки:

400 - Неверный код верификации или текущий пароль

409 - Пользователь с таким email или username уже найден

##### Отправка кода верификации для смены email
```
POST /users/@me/email/verify
```

JSON форма:

| Название     | Тип | Примечание                         |
|--------------|-----|------------------------------------|
| email        | str |                                    |

Результат:

Code 204

### Типы
##### Список типов
```
GET /types
```
Результат:

| Название  | Тип          | Примечание |
|-----------|--------------|------------|
| items     | list of Type |            |

##### Создание типа
```
POST /types
```
JSON форма:

| Название  | Тип | Примечание |
|-----------|-----|------------|
| view_name | str |            |

Результат:

Type

Ошибки

400 - Ошибка в отправляемых данных

409 - Тип с указанным view_name существует

##### Редактирование типа
```
PATCH /types/{id}
```
Аргументы:

| Название | Тип | Примечание             |
|----------|-----|------------------------|
| id       | int | id редактируемого типа |

JSON форма:

| Название  | Тип | Примечание |
|-----------|-----|------------|
| view_name | str |            |

Результат:

Type

Ошибки

400 - Ошибка в отправляемых данных

404 - Редактируемый тип не найден

409 - Тип с указанным view_name существует

##### Удаление типа
```
DELETE /types/{id}
```
Аргументы:

| Название | Тип | Примечание         |
|----------|-----|--------------------|
| id       | int | id удаляемого типа |

Результат: 

Code 204

### Тайтлы
##### Список тайтлов
```
GET /titles
```
Аргументы:

| Название | Тип         | Примечание                                  |
|----------|-------------|---------------------------------------------|
| type_id  | null or int | Фильтр по типу                              |
| status   | null or str | COMPLETE, IN_PROGRESS, ABANDONED, COMPLETED |
| search   | null or str | Поиск по названию                           |
| limit    | null or int |                                             |
| offset   | null or int |                                             |

Результат

| Название  | Тип           | Примечание |
|-----------|---------------|------------|
| items     | list of Title |            |

##### Получение тайтла
```
GET /title/{id}
```
Аргументы:

| Название | Тип | Примечание                |
|----------|-----|---------------------------|
| id       | int | id запрашиваемоего тайтла |

Результат:

Title

Ошибки:

404 - Запрашиваемый тайтл не найден

##### Создание тайтла
```
POST /titles
```
JSON форма:

| Название | Тип         | Примечание            |
|----------|-------------|-----------------------|
| name     | str         |                       |
| cover    | null or str | ссылка на изображение |
| type_id  | int         | id существующего типа |

Результат:

Title

Ошибки:

400 - Ошибка в отправляемых данных

##### Редактирование типа
```
PATCH /titles/{id}
```
Аргументы:

| Название | Тип | Примечание               |
|----------|-----|--------------------------|
| id       | int | id редактируемого тайтла |

JSON форма:

| Название | Тип         | Примечание            |
|----------|-------------|-----------------------|
| name     | str  or str |                       |
| cover    | null or str | ссылка на изображение |
| type_id  | int  or str | id существующего типа |

Результат:

Title

Ошибки:

400 - Ошибка в отправляемых данных

##### Удаление тайтла
```
DELETE /titles/{id}
```
Аргументы:

| Название | Тип | Примечание           |
|----------|-----|----------------------|
| id       | int | id удаляемого тайтла |

Результат:

Code 204

### Статусы тайтлов
##### Изменение статуса тайтла
```
POST /titles/{id}/state
```
Аргументы:

| Название | Тип | Примечание |
|----------|-----|------------|
| id       | int | id  тайтла |

JSON Форма

| Название | Тип         | Примечание                                  |
|----------|-------------|---------------------------------------------|
| state    | str or null | COMPLETE, IN_PROGRESS, ABANDONED, COMPLETED |

Результат:
Code 204

### Response models
##### Type
| Название  | Тип | Примечание                 |
|-----------|-----|----------------------------|
| id        | int | Генерируется автоматически |
| view_name | str |                            |

##### Title
| Название    | Тип         | Примечание                                  |
|-------------|-------------|---------------------------------------------|
| id          | int         | Генерируется автоматически                  |
| name        | str         |                                             |
| cover       | null or str |                                             |
| type        | Type        |                                             |
| user_status | null or str | COMPLETE, IN_PROGRESS, ABANDONED, COMPLETED |

##### User
| Название | Тип         | Примечание                       |
|----------|-------------|----------------------------------|
| id       | int         | Генерируется автоматически       |
| email    | str         | Имеется только если профиль свой |
| username | str         |                                  |
| avatar   | null or str |                                  |

##### Error
| Название | Тип      | Примечание |
|----------|----------|------------|
| msg      | str      |            |